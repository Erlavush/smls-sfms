--- START FILE: .gitignore ---
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts


--- END FILE: .gitignore ---

--- START FILE: eslint.config.mjs ---
import { dirname } from "path";
import { fileURLToPath } from "url";
import { FlatCompat } from "@eslint/eslintrc";

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const compat = new FlatCompat({
  baseDirectory: __dirname,
});

const eslintConfig = [
  ...compat.extends("next/core-web-vitals", "next/typescript"),
];

export default eslintConfig;


--- END FILE: eslint.config.mjs ---

--- START FILE: next-env.d.ts ---
/// <reference types="next" />
/// <reference types="next/image-types/global" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.


--- END FILE: next-env.d.ts ---

--- START FILE: next.config.ts ---
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
};

export default nextConfig;


--- END FILE: next.config.ts ---

--- START FILE: package.json ---
{
  "name": "smls-sfms",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  },
  "dependencies": {
    "@next-auth/prisma-adapter": "^1.0.7",
    "@prisma/client": "^6.6.0",
    "bcrypt": "^5.1.1",
    "next": "15.3.1",
    "next-auth": "^4.24.11",
    "react": "^19.0.0",
    "react-dom": "^19.0.0"
  },
  "devDependencies": {
    "@eslint/eslintrc": "^3",
    "@tailwindcss/postcss": "^4",
    "@types/bcrypt": "^5.0.2",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "eslint": "^9",
    "eslint-config-next": "15.3.1",
    "prisma": "^6.6.0",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}


--- END FILE: package.json ---

--- START FILE: postcss.config.mjs ---
const config = {
  plugins: ["@tailwindcss/postcss"],
};

export default config;


--- END FILE: postcss.config.mjs ---

--- START FILE: README.md ---


Prisma
Next Auth 


--- END FILE: README.md ---

--- START FILE: tsconfig.json ---
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}


--- END FILE: tsconfig.json ---

--- START FILE: prisma\schema.prisma ---
// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// Define the possible roles for users
enum Role {
  FACULTY
  ADMIN
}

// Define the User model
model User {
  id        String   @id @default(cuid()) // Unique ID for the user (using cuid)
  name      String?                       // User's name (optional for now)
  email     String   @unique                 // User's email, must be unique
  password  String                        // Hashed password (we will hash it before saving)
  role      Role     @default(FACULTY)     // User's role (defaults to FACULTY)
  createdAt DateTime @default(now())         // Timestamp when the user was created
  updatedAt DateTime @updatedAt            // Timestamp when the user was last updated

  // Add relationships to other models later if needed
  // e.g., documents Document[]
}

// Add other models like Document, etc. later below


--- END FILE: prisma\schema.prisma ---

--- START FILE: prisma\migrations\migration_lock.toml ---
# Please do not edit this file manually
# It should be added in your version-control system (e.g., Git)
provider = "sqlite"


--- END FILE: prisma\migrations\migration_lock.toml ---

--- START FILE: prisma\migrations\20250426170451_init_user_model\migration.sql ---
-- CreateTable
CREATE TABLE "User" (
    "id" TEXT NOT NULL PRIMARY KEY,
    "name" TEXT,
    "email" TEXT NOT NULL,
    "password" TEXT NOT NULL,
    "role" TEXT NOT NULL DEFAULT 'FACULTY',
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" DATETIME NOT NULL
);

-- CreateIndex
CREATE UNIQUE INDEX "User_email_key" ON "User"("email");


--- END FILE: prisma\migrations\20250426170451_init_user_model\migration.sql ---

--- START FILE: src\app\globals.css ---
/* src/app/globals.css */

/* Import Tailwind's base styles (preflight) for v4 */
@import "tailwindcss/preflight";

/* Include Tailwind's utility classes for v4 */
@tailwind utilities;

/* Your custom styles and CSS variables */
:root {
  --background: #ffffff;
  --foreground: #171717;
  /* Define fonts if needed, e.g., using next/font */
  /* --font-sans: ...; */
  /* --font-mono: ...; */
}


body {
  background: var(--background);
  color: var(--foreground);
  /* Consider using your defined font variable here if set up */
  /* font-family: var(--font-sans), Arial, Helvetica, sans-serif; */
  font-family: Arial, Helvetica, sans-serif; /* Or keep the basic fallback */
}

/* You can add custom utility layers or component styles below if needed */
/* Example:
@layer utilities {
  .my-custom-utility {
    @apply ...;
  }
}
*/


--- END FILE: src\app\globals.css ---

--- START FILE: src\app\layout.tsx ---
// src/app/layout.tsx
import type { Metadata } from "next";
import "./globals.css";
import NextAuthProvider from "@/components/providers/NextAuthProvider"; // Import the provider

export const metadata: Metadata = {
  title: "SMLS-SFMS",
  description: "Skills and Faculty Management System",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body>
        {/* Wrap the main content (or entire body content) with the provider */}
        <NextAuthProvider>
           {/* You can add global layout elements like Header/Footer here if needed */}
           {/* Make sure they are inside NextAuthProvider if they need session data */}
           <main>{children}</main> {/* Page content */}
        </NextAuthProvider>
      </body>
    </html>
  );
}


--- END FILE: src\app\layout.tsx ---

--- START FILE: src\app\page.tsx ---
// src/app/page.tsx
'use client'; // Needs to be a client component to use the hook

import React from 'react';
import { useSession, signIn, signOut } from 'next-auth/react';
import Link from 'next/link'; // Import Link

export default function HomePage() {
    // Use the useSession hook to get session data
    const { data: session, status } = useSession();

    // status can be 'loading', 'authenticated', or 'unauthenticated'

    return (
        <div className="p-6">
            <h1 className="text-2xl font-semibold mb-4 text-[#003153]">Welcome to SMLS-SFMS!</h1>

            {status === 'loading' && (
                <p className="text-gray-500">Loading session...</p>
            )}

            {status === 'authenticated' && session?.user && (
                <div className="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert">
                    <p>Signed in as: <strong>{session.user.email}</strong></p>
                    {/* We added 'role' to the session in authOptions callbacks */}
                    <p>Role: <strong>{(session.user as any).role}</strong></p>
                    <button
                        onClick={() => signOut()} // Call signOut from next-auth/react
                        className="mt-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded shadow"
                    >
                        Sign Out
                    </button>
                </div>
            )}

            {status === 'unauthenticated' && (
                 <div className="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded relative mb-4" role="alert">
                    <p>You are not signed in.</p>
                    <Link href="/login"> {/* Use Link for client-side navigation */}
                       <button
                          className="mt-2 px-4 py-2 bg-[#003153] hover:bg-[#002742] text-white rounded shadow"
                       >
                           Sign In
                       </button>
                    </Link>
                 </div>
            )}

             <p className="mt-4">This is the homepage content.</p>
             {/* We can add links to other sections later */}

        </div>
    );
}


--- END FILE: src\app\page.tsx ---

--- START FILE: src\app\(auth)\login\page.tsx ---
// src/app/(auth)/login/page.tsx
'use client'; // Mark this as a Client Component

import React, { useState, FormEvent } from 'react';
import { signIn } from 'next-auth/react'; // We'll use this to trigger login
import { useRouter } from 'next/navigation'; // To redirect after login

export default function LoginPage() {
    const [email, setEmail] = useState('');
    const [password, setPassword] = useState('');
    const [error, setError] = useState<string | null>(null); // To display login errors
    const [isLoading, setIsLoading] = useState(false);
    const router = useRouter();

    const handleSubmit = async (event: FormEvent<HTMLFormElement>) => {
        event.preventDefault(); // Prevent default form submission
        setError(null); // Clear previous errors
        setIsLoading(true);

        try {
            // Attempt to sign in using the 'credentials' provider
            const result = await signIn('credentials', {
                redirect: false, // Prevent NextAuth from automatically redirecting
                email: email,
                password: password,
            });

            setIsLoading(false);

            if (result?.error) {
                // Handle errors (e.g., wrong password, user not found)
                console.error("Sign In Error:", result.error);
                setError("Invalid email or password. Please try again."); // Generic error message
            } else if (result?.ok) {
                // Sign in successful
                console.log("Sign in successful!");
                // Redirect to the faculty dashboard (or based on role later)
                router.push('/dashboard'); // Or use router.replace('/dashboard')
                // Force refresh page state after redirect to ensure layout updates etc.
                router.refresh();
            } else {
                 setError("An unknown error occurred during login.");
            }

        } catch (error) {
            setIsLoading(false);
            console.error("Login submission failed:", error);
            setError("An unexpected error occurred. Please try again later.");
        }
    };

    return (
        <div className="flex min-h-screen items-center justify-center bg-gray-100"> {/* Light gray background for contrast */}
            <div className="w-full max-w-md rounded-lg bg-white p-8 shadow-md"> {/* White login card */}
                <h1 className="mb-6 text-center text-3xl font-semibold text-[#003153]"> {/* SMLS Blue Heading */}
                    SMLS-SFMS Login
                </h1>

                <form onSubmit={handleSubmit}>
                    {error && (
                        <div className="mb-4 rounded border border-red-400 bg-red-100 p-3 text-center text-red-700">
                            {error}
                        </div>
                    )}
                    <div className="mb-4">
                        <label
                            htmlFor="email"
                            className="mb-2 block text-sm font-medium text-gray-700"
                        >
                            Email Address
                        </label>
                        <input
                            type="email"
                            id="email"
                            name="email"
                            value={email}
                            onChange={(e) => setEmail(e.target.value)}
                            required
                            className="block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 shadow-sm focus:border-[#003153] focus:outline-none focus:ring-1 focus:ring-[#003153]" // Focus ring with SMLS blue
                            placeholder="your.email@example.com"
                            disabled={isLoading}
                        />
                    </div>

                    <div className="mb-6">
                        <label
                            htmlFor="password"
                            className="mb-2 block text-sm font-medium text-gray-700"
                        >
                            Password
                        </label>
                        <input
                            type="password"
                            id="password"
                            name="password"
                            value={password}
                            onChange={(e) => setPassword(e.target.value)}
                            required
                            className="block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 shadow-sm focus:border-[#003153] focus:outline-none focus:ring-1 focus:ring-[#003153]" // Focus ring with SMLS blue
                            placeholder="••••••••"
                            disabled={isLoading}
                        />
                        {/* Optional: Add "Forgot Password?" link here */}
                    </div>

                    <div>
                        <button
                            type="submit"
                            disabled={isLoading}
                            className={`w-full rounded-md px-4 py-2 text-white shadow-sm focus:outline-none focus:ring-2 focus:ring-[#003153] focus:ring-offset-2 ${
                                isLoading
                                    ? 'cursor-not-allowed bg-gray-400'
                                    : 'bg-[#003153] hover:bg-[#002742]' // SMLS Blue background, slightly darker on hover
                            }`}
                        >
                            {isLoading ? 'Signing In...' : 'Sign In'}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    );
}


--- END FILE: src\app\(auth)\login\page.tsx ---

--- START FILE: src\app\(faculty)\dashboard\page.tsx ---
// src/app/(faculty)/dashboard/page.tsx
'use client'; // Mark as Client Component to potentially use hooks later

import React from 'react';
import { useSession } from 'next-auth/react'; // Can use this to show user info

export default function FacultyDashboardPage() {
    const { data: session, status } = useSession();

    // You can add loading state based on session status if needed
    if (status === 'loading') {
        return <div className="p-6">Loading dashboard...</div>;
    }

    // Basic check if authenticated (though middleware/layout should handle this ideally)
    if (status === 'unauthenticated') {
         // This shouldn't usually be reached if protected routes are set up correctly
         // Redirecting or showing an error might be better.
        return <div className="p-6">Access Denied. Please sign in.</div>;
    }

    // Get user role (added in callbacks)
    const userRole = (session?.user as any)?.role;

    return (
        <div className="p-6">
            <h1 className="mb-4 text-2xl font-semibold text-[#003153]">
                Faculty Dashboard
            </h1>

            {session?.user && (
                <p className="mb-4">
                    Welcome, {session.user.name ?? session.user.email}!
                    (Role: {userRole})
                </p>
            )}

            <p>This is where faculty-specific information and actions will go.</p>

            {/* Example placeholder sections */}
            <div className="mt-6 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3">
                <div className="rounded border border-gray-200 bg-white p-4 shadow">
                    <h2 className="mb-2 text-lg font-medium text-[#003153]">My Profile</h2>
                    <p className="text-sm text-gray-600">View or update your profile details.</p>
                    {/* Link to profile page later */}
                </div>
                <div className="rounded border border-gray-200 bg-white p-4 shadow">
                    <h2 className="mb-2 text-lg font-medium text-[#003153]">My Documents</h2>
                    <p className="text-sm text-gray-600">Upload and manage your credentials.</p>
                     {/* Link to documents page later */}
                </div>
                 <div className="rounded border border-gray-200 bg-white p-4 shadow">
                    <h2 className="mb-2 text-lg font-medium text-[#003153]">Upcoming Events</h2>
                    <p className="text-sm text-gray-600">View relevant seminars or deadlines.</p>
                     {/* Placeholder content */}
                </div>
            </div>
        </div>
    );
}


--- END FILE: src\app\(faculty)\dashboard\page.tsx ---

--- START FILE: src\app\(faculty)\documents\page.tsx ---
[EMPTY FILE]

--- END FILE: src\app\(faculty)\documents\page.tsx ---

--- START FILE: src\app\(faculty)\profile\page.tsx ---
[EMPTY FILE]

--- END FILE: src\app\(faculty)\profile\page.tsx ---

--- START FILE: src\app\admin\approvals\page.tsx ---
[EMPTY FILE]

--- END FILE: src\app\admin\approvals\page.tsx ---

--- START FILE: src\app\admin\dashboard\page.tsx ---
[EMPTY FILE]

--- END FILE: src\app\admin\dashboard\page.tsx ---

--- START FILE: src\app\admin\faculty\page.tsx ---
[EMPTY FILE]

--- END FILE: src\app\admin\faculty\page.tsx ---

--- START FILE: src\app\admin\faculty\[facultyId]\page.tsx ---
[EMPTY FILE]

--- END FILE: src\app\admin\faculty\[facultyId]\page.tsx ---

--- START FILE: src\app\admin\matrix\page.tsx ---
[EMPTY FILE]

--- END FILE: src\app\admin\matrix\page.tsx ---

--- START FILE: src\app\api\auth\[...nextauth]\route.ts ---
// src/app/api/auth/[...nextauth]/route.ts
import NextAuth, { type NextAuthOptions } from 'next-auth';
import CredentialsProvider from 'next-auth/providers/credentials';
import { PrismaAdapter } from '@next-auth/prisma-adapter';
import bcrypt from 'bcrypt';
import prisma from '@/lib/prisma'; // Import the singleton Prisma Client instance

export const authOptions: NextAuthOptions = {
    // Configure Prisma Adapter
    adapter: PrismaAdapter(prisma),

    // Configure one or more authentication providers
    providers: [
        CredentialsProvider({
            // The name to display on the sign in form (e.g. "Sign in with...")
            name: 'Credentials',
            // `credentials` is used to generate a form on the sign in page.
            credentials: {
                email: { label: "Email", type: "email", placeholder: "jsmith@example.com" },
                password: { label: "Password", type: "password" }
            },
            async authorize(credentials, req) {
                // Add logic here to look up the user from the credentials supplied
                if (!credentials?.email || !credentials?.password) {
                    console.error('Credentials missing');
                    return null; // Indicate failure: credentials not provided
                }

                try {
                    // Find the user in the database using the imported prisma instance
                    const user = await prisma.user.findUnique({
                        where: { email: credentials.email }
                    });

                    if (!user) {
                        console.error('No user found with email:', credentials.email);
                        // Optionally: throw new Error("No user found."); // Can provide feedback
                        return null; // User not found
                    }

                    // Validate the password using bcrypt.compare
                    const isValidPassword = await bcrypt.compare(
                        credentials.password, // Plain password from login form
                        user.password         // Hashed password from database
                    );

                    if (!isValidPassword) {
                        console.error('Invalid password for user:', credentials.email);
                        // Optionally: throw new Error("Invalid password."); // Can provide feedback
                        return null; // Password doesn't match
                    }

                    console.log('User authorized:', user.email);
                    // Return user object if credentials are valid
                    // This object must satisfy NextAuth's User type (at least 'id')
                    // Using 'as any' here simplifies typing for now.
                    return {
                        id: user.id,
                        name: user.name,
                        email: user.email,
                        role: user.role, // Include the role
                    } as any;

                } catch (error) {
                    console.error("Error during authorization:", error);
                    return null; // Return null on any unexpected error during authorization
                }
            }
        })
        // ...add more providers here (e.g., Google, GitHub)
    ],

    // Define how session is managed
    session: {
        strategy: "jwt", // Use JSON Web Tokens for session management
    },

    // Callbacks are asynchronous functions you can use to control what happens
    callbacks: {
        // Add user id and role to the JWT payload
        async jwt({ token, user }) {
            if (user) {
                // The 'user' object here comes from the 'authorize' function or DB lookup
                token.id = user.id;
                // Need type assertion because 'role' isn't part of default JWT token type
                token.role = (user as any).role;
            }
            return token;
        },
        // Add user id and role to the session object available client-side
        async session({ session, token }) {
            if (token && session.user) {
                 // Need type assertion to add custom properties to default Session['user']
                (session.user as any).id = token.id;
                (session.user as any).role = token.role;
            }
            return session;
        },
    },

    // Specify pages for login, error handling, etc.
    pages: {
        signIn: '/login', // Redirect users to /login if they need to sign in
        // error: '/auth/error', // Optional: Custom error page
    },

    // Secret for signing tokens (required) - loaded from .env.local
    secret: process.env.NEXTAUTH_SECRET,

    // Enable debug messages in development for easier troubleshooting
    debug: process.env.NODE_ENV === 'development',
};

// Export the NextAuth handler for GET and POST requests
const handler = NextAuth(authOptions);
export { handler as GET, handler as POST };


--- END FILE: src\app\api\auth\[...nextauth]\route.ts ---

--- START FILE: src\app\api\documents\route.ts ---
[EMPTY FILE]

--- END FILE: src\app\api\documents\route.ts ---

--- START FILE: src\app\api\faculty\route.ts ---
[EMPTY FILE]

--- END FILE: src\app\api\faculty\route.ts ---

--- START FILE: src\components\providers\NextAuthProvider.tsx ---
// src/components/providers/NextAuthProvider.tsx
'use client'; // This component wraps SessionProvider, so it must be a Client Component

import { SessionProvider } from 'next-auth/react';
import React from 'react';

interface Props {
    children: React.ReactNode;
    // We might pass the session from the server later for optimization,
    // but for now, SessionProvider will fetch it client-side.
}

export default function NextAuthProvider({ children }: Props) {
    return <SessionProvider>{children}</SessionProvider>;
}

[EMPTY FILE]

--- END FILE: src\lib\auth.ts ---

--- START FILE: src\lib\db.ts ---
[EMPTY FILE]

--- END FILE: src\lib\db.ts ---

--- START FILE: src\lib\prisma.ts ---
// src/lib/prisma.ts
import { PrismaClient } from '@/generated/prisma';

// Declare a global variable to hold the Prisma Client instance.
// We use 'globalThis' which works in different environments (Node, browser, edge).
// We add '_prisma' to avoid potential naming conflicts.
declare global {
  // eslint-disable-next-line no-var
  var _prisma: PrismaClient | undefined;
}

// Check if we already have an instance in the global scope.
// If not, create a new one. In development, due to Next.js hot reloading,
// 'global._prisma' might already exist, so we reuse it to avoid creating too many connections.
const prisma = globalThis._prisma ?? new PrismaClient();

// In non-production environments, assign the instance to the global scope.
if (process.env.NODE_ENV !== 'production') {
  globalThis._prisma = prisma;
}

// Export the single instance.
export default prisma;


--- END FILE: src\lib\prisma.ts ---

--- START FILE: src\lib\utils.ts ---
[EMPTY FILE]

--- END FILE: src\lib\utils.ts ---

--- START FILE: src\types\index.ts ---
[EMPTY FILE]

--- END FILE: src\types\index.ts ---

